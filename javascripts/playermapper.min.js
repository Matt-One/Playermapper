/*! Playermapper - CDawg [20170811] */
var site=document.domain;var char_matrix=map_matrix=1;var map_buffer="";var zoom=100;var zoom_max=350;var zoom_min=25;var map_x=map_y=map_drag_x=map_drag_y=screen_x=screen_y=cursor_x=cursor_y=zone=map_count=click_stop=0;var dk_zone=1;var click_delay=80;function getElementsStartsWithId( id ){var children=document.body.getElementsByTagName('*');var elements=[], child;for (var i=0, length=children.length; i < length; i++) {child=children[i];if(child.id.substr(0, id.length)==id)elements.push(child);}return elements;}var console_load_delay=20;function console(log, header){if(header){$("#console_data").append('<div class="console_header">'+log+'</div>');}else {$("#console_data").append('<div class="console_line">'+log+'</div>');}$("#console").animate({ scrollTop: $("#console")[0].scrollHeight}, console_load_delay);$(".console_line").click(function() {var fp=$(this).text();fp=fp.substring(0, fp.indexOf(' - ')).toLowerCase();var footprint=getElementsStartsWithId(fp);if(!fp) {return;}$(".fp").hide();if($(".fp")){$(footprint).show();$(".fp_searchmarker").show().css({"opacity":"0.6"});}setTimeout(function(){$(".fp_searchmarker").hide();$(".fp").show();}, 450);}).delay(500).stop();}function showCharMatrix(){if(char_matrix){$("#char_matrix").hide();char_matrix=0;}else{$("#char_matrix").show();char_matrix=1;}}function showMapMatrix(){if(map_matrix){$(".map").css('background-image', 'none');$("#dk_zone").hide();map_matrix=0;dk_zone=0;}else{$(".map").css('background-image', map_buffer);$("#dk_zone").show();$("#checkbox_dkstart").prop("checked", true);map_matrix=1;dk_zone=1;$(".dk").show();}}function showMapZones(){if(!zone){$(".zone-bind").css("opacity", "0.4");zone=1;}else{$(".zone-bind").css("opacity", "0.0");$(".zone-bind").hover(function(){$(this).css("opacity", "0.4");}, function(){$(this).css("opacity", "0.0");});zone=0;}}function showDKZone(){if(dk_zone){$("#dk_zone").fadeOut(500).css({"borderColor":"transparent"});$(".dk").fadeOut(500);dk_zone=0;}else{$("#dk_zone").fadeIn(500).css({"borderColor":"#4d4d4d"});$(".dk").fadeIn(500);dk_zone=1;}}function zoneIdentity(name){$("#minimap_title").html(name);$("#minimap_title").stop().css("background-color", "#717171").animate({ backgroundColor: "#181818"}, 500);}function toTitleCase(str){return str.replace(/\w\S*/g, function(txt){return txt.charAt(0).toUpperCase()+txt.substr(1).toLowerCase();});}function mapCount(){map_count+= 1;$("#map_count").html(map_count);}function loadCharacterFP(load){var load_delay=console_load_delay *4;if(!load){load_delay=0;}$(".fp_searchmarker").each(function( index ) {setTimeout(function(){fpsm="#sm_"+(index+1);var fp_id=$(fpsm).parent().prop("id");if(load){$("#"+fp_id).show();}var fp_ex=fp_id.replace("_", " - ");var fp=fp_ex.charAt(0).toUpperCase()+fp_ex.slice(1);if(load){console(toTitleCase(fp));mapCount();}$(fpsm).show();$(fpsm).stop().css({"zoom":"6","-moz-transform":"scale(5)"}).animate({"zoom": "1","-moz-transform":"scale(1)"}, 500).delay(20).css({"opacity":"0.4"}).animate({"opacity":"0"}, 600);}, load_delay * index);});}function zoneZoom(zone){/*console($("#"+zone).attr("name"));*/if(click_stop){return;}/*$("#"+zone).dblclick(function(){*/if(zone=="zone_5416"){window.location.href="Deepholm";return;}if(zoom <= 140){setTimeout(function(){$(".map").css({"left":(screen_x /4 - cursor_x-100)+"px","top":(screen_y /4 - cursor_y-100)+"px"});}, 300);setTimeout(function(){zoom=350;$(".map").css({"zoom": zoom+"%"});$("#zoom_val").text(zoom+'%');var zoom_val_bg=$("#zoom_val").css('backgroundColor');}, 50);}/*});*/}$( function(){var map_id=$(".map").prop("id");var expansion=$("#expansion").text();var expansionPath="";var version=$("#version").text();screen_x=$(window).width();screen_y=$(window).height();console("Playermapper:", true);console(version);console("Expansion:", true);console(expansion);console("Browser Resolution:", true);console(screen_x+"x"+screen_y);console("Loading Map Matrix:", true);console(map_id.charAt(0).toUpperCase()+map_id.slice(1));if(map_id=="azeroth"){expansionPath=expansion+"/";}var zonejsonPath="json/"+expansionPath+map_id+".json";console("Loading Zone Matrix:", true);$.getJSON(zonejsonPath, function(data){for (i=0; i<data[0]["zone"].length; i++){console(data[0]["zone"][i]["name"]);}});$( document ).on( "mousemove", function( event ) {cursor_x=event.pageX;cursor_y=event.pageY;});setTimeout(function(){map_buffer=$(".map").css('background-image');map_center_x=$(".map").css('background-image');}, 1000);setTimeout(function(){console("Loading Character Matrix:", true);loadCharacterFP(true);}, 200);$(".map").draggable({cursor:"move",drag: function(){var offset=$(this).offset();map_drag_x=offset.left;map_drag_y=offset.top;click_stop=1;},stop: function(){setTimeout(function(){click_stop=0;}, click_delay);}});$(".map").mousewheel(function(turn, delta){if(delta==1){if(zoom>zoom_max-5)return false;zoom+=5;}else {if(zoom<zoom_min+5)return false;zoom-=5;}$(this).css({"zoom": zoom+"%","-moz-transform":"scale("+zoom/100+")"});$("#zoom_val").text(zoom+'%');$("#zoom_val").css("background", "#f2f590");var zoom_val_bg=$("#zoom_val").css('background');setTimeout(function(){$("#zoom_val").css({"background":"-webkit-linear-gradient(#656565, #181818)","background":"-o-linear-gradient(#656565, #181818)","background":"-moz-linear-gradient(#656565, #181818)","background":"linear-gradient(#656565, #181818)"}).hover(function() {$(this).css({"background":"#ffffff","color":"#000000"});}, function() {$(this).css({"background":"-webkit-linear-gradient(#656565, #181818)","background":"-o-linear-gradient(#656565, #181818)","background":"-moz-linear-gradient(#656565, #181818)","background":"linear-gradient(#656565, #181818)","color":"#ffffff"});});}, 100);return false;});$(".map").mousedown(function(e){if( e.button==2 ) {mapZoom(0);return false;}return true;});$("#help").animate({marginLeft:"-300px", opacity:0.7}, 2000);setTimeout(function(){$("#help").animate({marginLeft:"-30px", opacity:0.4}, 2000);}, 5000);$(".fp").hover(function() {var fp_details=$(this).children().text();$("#fp_detail").html(fp_details.replace(']', ']<br>'));$("#fp_detail").show();}, function() {$("#fp_detail").hide();});/*setTimeout(function(){$("#char_matrix" ).load("matrix.php");}, 7000);*/});var helpExt=0;function openHelp(){if(helpExt){helpExt=0;$("#help").animate({marginLeft:"-30px", opacity:0.7}, 700);}else {helpExt=1;$("#help").animate({marginLeft:"-300px", opacity:0.7}, 700);}}$(window).mousemove(function(e){$("#fp_detail").css({'top': e.clientY+15, 'left': e.clientX+15})});function mapShift(dir){if(dir==1){map_y+=50;$('.map').css("top", map_y+map_drag_y);}else if(dir==2){map_y -=50;$('.map').css("top", map_y+map_drag_y);}else if(dir==3){map_x+=50;$('.map').css("left", map_x+map_drag_x);}else if(dir==4){map_x -=50;$('.map').css("left", map_x+map_drag_x);}else{map_x=map_y=map_drag_x=map_drag_y=0;mapResetPos();}}function mapZoom(zdir){if(zoom >= zoom_max){zoom=zoom_max-1;return;}if(zoom <= zoom_min){zoom=zoom_min+1;return}if(zdir==2){zoom+=5;}else if(zdir==1){zoom-=5.0;}else{zoom=100;mapShift(0);}$(".map").css({"zoom":zoom+"%","-moz-transform":"scale("+zoom/100+")"});$("#zoom_val").text(zoom+"%");}function search(e){var eventInstance=window.event ? event : e;var keyCode=eventInstance.charCode ? eventInstance.charCode : eventInstance.keyCode;if((keyCode==13) || (e=="click")){var query=$("#search_in").val();if((query != "*") && (query != "%") && (query.length > 1)){/*Search Zones*//*$("#"+zone).attr("name");*/var footprint=getElementsStartsWithId(query);$(".fp").hide();loadCharacterFP(false);if($(".fp")){$(footprint).show();}}else {alert("Invalid query!\n\nPlease enter a zone or player name.\nMinimum 2 characters in length");}}else{if(e=="cancel"){$(".fp").show().css({"fontSize" : "10pt","textShadow" : "0px 0px 1px #fff","marginLeft" : "0px","marginTop" : "0px",});$("#search_in").val("");}}}